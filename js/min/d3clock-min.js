function initGeolocation(){void 0!==getUrlValue("destination")?(window.destination=getUrlValue("destination"),navigator.geolocation?navigator.geolocation.getCurrentPosition(success,fail):alert("Sorry, your browser does not support geolocation services.")):alert("Sorry, no location entered!")}function success(t){getTransitTime(t.coords.latitude,t.coords.longitude)}function fail(){}function getTransitTime(t,e){var a=new google.maps.DirectionsService,n={origin:t+","+e,destination:"40.696319,-73.960623",travelMode:google.maps.DirectionsTravelMode.TRANSIT};a.route(n,function(a,n){if(console.log(t+","+e),n==google.maps.DirectionsStatus.OK){if(console.log(a),r in a.routes[0].legs[0])var r=a.routes[0].legs[0].arrival_time.value;else{var r=new Date;r.setSeconds(r.getSeconds()+a.routes[0].legs[0].duration.value)}window.transitHandData[0].value=r.getHours()%12+r.getMinutes()/60,window.transitHandData[1].value=r.getMinutes()+r.getSeconds()/60,window.transitHandData[2].value=r.getSeconds(),console.log(window.transitHandData);var o=d3.select("#transit-hands");o.selectAll("path").data(window.transitHandData).enter().append("path").attr("class",function(t){return t.type+"-transitHand transitHand"}).attr("d",function(t){return"M"+t.width/2+" "+t.balance+" L"+t.width/-2+" "+t.balance+" L0 "+t.length+" Z"}).attr("transform",function(t){return"rotate("+t.scale(t.value)%360+")"})}})}var getUrlValue=function(t){for(var e=window.location.search.substring(1),a=e.split("&"),n=0;n<a.length;n++){var r=a[n].split("=");if(r[0]===t)return r[1]}},d3clockfunc=function(t,e,a){function n(){o();var t=e.find("svg")[0],a=d3.select(t).attr("width",c).attr("height",d).attr("viewBox","0 0 "+c+" "+d).attr("preserveAspectRatio","xMidyMid"),n=a.append("g").attr("id","clock-face").attr("transform","translate("+(l+s)+","+(l+s)+")");n.selectAll(".second-tick").data(d3.range(0,60)).enter().append("line").attr("class","second-tick").attr("x1",0).attr("x2",0).attr("y1",y).attr("y2",y+secondTickLength).attr("transform",function(t){return console.log("minutetick"),"rotate("+S(t/1)%360+")"}),n.selectAll(".hour-tick").data(d3.range(0,12)).enter().append("line").attr("class","hour-tick").attr("x1",0).attr("x2",0).attr("y1",hourTickStart).attr("y2",hourTickStart+hourTickLength).attr("transform",function(t){return"rotate("+k(t)+")"}),n.selectAll(".hour-label").data(d3.range(0,12)).enter().append("text").attr("class","hour-label").attr("text-anchor","middle").attr("x",function(t){return hourLabelRadius*Math.sin(k(t)*i)}).attr("y",function(t){return-hourLabelRadius*Math.cos(k(t)*i)+hourLabelYOffset}).text(function(t){return(t+11)%12+1}),n.append("g").attr("id","face-overlay").append("circle").attr("class","hands-cover").attr("x",0).attr("y",0).attr("r",l/50);var r=d3.select("#clock-face").append("g").attr("id","transit-hands"),u=n.append("g").attr("id","clock-hands");u.selectAll("path").data(M).enter().append("path").attr("class",function(t){return t.type+"-hand hand"}).attr("d",function(t){return"M"+t.width/2+" "+t.balance+" L"+t.width/-2+" "+t.balance+" L0 "+t.length+" Z"}).attr("transform",function(t){return"rotate("+t.scale(t.value)%360+")"})}function r(){d3.select("#clock-hands").selectAll("path").data(M).transition().ease("linear").attr("transform",function(t){return"rotate("+t.scale(t.value)%360+")"})}function o(){var t=new Date,e=3600*t.getHours()+60*t.getMinutes()+t.getSeconds(),a=1e3*e+t.getMilliseconds();M[0].value=t.getHours()%12+t.getMinutes()/60,M[1].value=t.getMinutes()+t.getSeconds()/60,M[2].value=t.getSeconds()}var i=.0174532925,l=200,s=50,c=2*(l+s),d=2*(l+s),u=2*l/4,g=10,h=20,f=l-30,p=8,v=20,w=4,b=l,m=30,y=l;secondTickLength=-10,hourTickStart=l,hourTickLength=-18,secondLabelRadius=l+16,secondLabelYOffset=5,hourLabelRadius=l-40,hourLabelYOffset=7;var k=d3.scale.linear().domain([0,12]).range([0,360]),L=d3.scale.linear().domain([0,60]).range([0,360]),S=d3.scale.linear().domain([0,60]).range([0,360]),M=[{type:"hour",value:0,scale:k,length:-u,balance:h,width:g},{type:"minute",value:0,scale:L,length:-f,balance:v,width:p},{type:"second",value:0,scale:S,length:-b,balance:m,width:w}];window.transitHandData=[{type:"hour",value:0,scale:k,length:-u,balance:h,width:g},{type:"minute",value:0,scale:L,length:-f,balance:v,width:p},{type:"second",value:0,scale:S,length:-b,balance:m,width:w}],n(),initGeolocation(),setInterval(function(){o(),r()},100),d3.select(self.frameElement).style("height",d+"px")};
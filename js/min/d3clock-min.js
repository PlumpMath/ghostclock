function initGeolocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(success,fail):alert("Sorry, your browser does not support geolocation services.")}function success(t){getTransitTime(t.coords.latitude,t.coords.longitude)}function fail(){}function getTransitTime(t,e){window.destAddress="808 West End Ave, New York";var a=new google.maps.DirectionsService,n={origin:"40.7551582,-73.9410288999999",destination:window.destAddress,travelMode:google.maps.DirectionsTravelMode.TRANSIT};a.route(n,function(t,e){if(e==google.maps.DirectionsStatus.OK){console.log(t);var a=t.routes[0].legs[0].arrival_time.value;window.transitHandData[0].value=a.getHours()%12,window.transitHandData[1].value=a.getMinutes(),window.transitHandData[2].value=a.getSeconds(),console.log(window.transitHandData);var n=d3.select("#transit-hands");n.selectAll("path").data(window.transitHandData).enter().append("path").attr("class",function(t){return t.type+"-transitHand transitHand"}).attr("d",function(t){return"M"+t.width/2+" "+t.balance+" L"+t.width/-2+" "+t.balance+" L0 "+t.length+" Z"}).attr("transform",function(t){return"rotate("+(t.scale(t.value)+30)%360+")"})}})}var d3clockfunc=function(t,e,a){function n(){i();var t=e.find("svg")[0],a=d3.select(t).attr("width",d).attr("height",u).attr("viewBox","0 0 "+d+" "+u).attr("preserveAspectRatio","xMidyMid"),n=a.append("g").attr("id","clock-face").attr("transform","translate("+(l+c)+","+(l+c)+")");n.selectAll(".second-tick").data(d3.range(0,59)).enter().append("line").attr("class","second-tick").attr("x1",0).attr("x2",0).attr("y1",M).attr("y2",M+secondTickLength).attr("transform",function(t){return console.log("minutetick"),"rotate("+A(t/1)%360+")"}),n.selectAll(".hour-label").data(d3.range(0,12)).enter().append("text").attr("class","hour-label").attr("text-anchor","middle").attr("x",function(t){return hourLabelRadius*Math.sin(L(t)*s+Math.PI)}).attr("y",function(t){return-hourLabelRadius*Math.cos(L(t)*s+Math.PI)+hourLabelYOffset}).text(function(t){return(t+5)%12+1}),n.append("g").attr("id","face-overlay").append("circle").attr("class","hands-cover").attr("x",0).attr("y",0).attr("r",l/50);var r=d3.select("#clock-face").append("g").attr("id","transit-hands"),o=n.append("g").attr("id","clock-hands");o.selectAll("path").data(H).enter().append("path").attr("class",function(t){return t.type+"-hand hand"}).attr("d",function(t){return"M"+t.width/2+" "+t.balance+" L"+t.width/-2+" "+t.balance+" L0 "+t.length+" Z"}).attr("transform",function(t){return"rotate("+t.scale(t.value)%360+")"})}function r(){d3.select("#clock-hands").selectAll("path").data(H).transition().ease("linear").attr("transform",function(t){return"rotate("+t.scale(t.value)%360+")"})}function i(){var t=new Date,e=3600*t.getHours()+60*t.getMinutes()+t.getSeconds(),a=1e3*e+t.getMilliseconds();H[0].value=t.getHours()%12,H[1].value=t.getMinutes(),H[2].value=t.getSeconds()}window.onresize=function(t){o()};var o=function(){var t=e.find("svg")[0],a=Math.min(window.innerWidth,window.innerHeight);t.setAttribute("height",a),t.setAttribute("width",a),t.style.marginTop=a/-2,console.log(t)},s=.0174532925,l=200,c=50,d=2*(l+c),u=2*(l+c),h=2*l/4,g=10,f=20,v=l-30,p=8,w=20,b=4,m=l,y=30,M=l;secondTickLength=-10,hourTickStart=l,hourTickLength=-18,secondLabelRadius=l+16,secondLabelYOffset=5,hourLabelRadius=l-40,hourLabelYOffset=7;var L=d3.scale.linear().domain([0,11]).range([0,360-360/11]),k=d3.scale.linear().domain([0,59]).range([0,359.9541666669319]),A=d3.scale.linear().domain([0,59]).range([0,359.99455833332973]),H=[{type:"hour",value:0,scale:L,length:-h,balance:f,width:g},{type:"minute",value:0,scale:k,length:-v,balance:w,width:p},{type:"second",value:0,scale:A,length:-m,balance:y,width:b}];window.transitHandData=[{type:"hour",value:0,scale:L,length:-h,balance:f,width:g},{type:"minute",value:0,scale:k,length:-v,balance:w,width:p},{type:"second",value:0,scale:A,length:-m,balance:y,width:b}],n(),initGeolocation(),o(),setInterval(function(){i(),r()},100),d3.select(self.frameElement).style("height",u+"px")};